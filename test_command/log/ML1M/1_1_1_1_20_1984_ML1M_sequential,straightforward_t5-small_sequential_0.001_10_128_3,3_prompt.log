2025-03-10 01:06:57,007 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML1M_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '1984', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'ML1M', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'unseen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 1, 'test_filtered_batch': 0, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_1984_ML1M_sequential,straightforward_t5-small_sequential_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML1M_sequential.pt'}
2025-03-10 01:06:57,008 - root - INFO - Generating data for ML1M dataset
2025-03-10 01:06:57,008 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-10 01:06:57,009 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-10 01:06:57,009 - root - INFO - Required info: ['user_id', 'dataset', 'history', 'target']
2025-03-10 01:06:57,109 - root - INFO - Reindex data with sequential indexing method
2025-03-10 01:06:58,582 - root - INFO - loading training data
2025-03-10 01:07:03,355 - root - INFO - Getting prompt information
2025-03-10 01:07:40,346 - root - INFO - Input: Here is the purchase history of ML1M user_1 : ML1M item item_1015 , item_1016 , item_1017 , item_1018 , item_1019 , item_1020 , item_1021 , item_1022 , item_1023 , item_1024 , item_1025 , item_1026 , item_1027 , item_1028 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 . I wonder what is the next recommended item for the user . , Output: ML1M item_1035 
2025-03-10 01:07:40,721 - root - INFO - Use t5-small backbone model
2025-03-10 01:07:41,063 - root - INFO - Random initialize number related tokens
2025-03-10 01:07:43,625 - root - INFO - Load model from ../checkpoint/ML1M_sequential.pt
2025-03-10 01:24:40,946 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML1M_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '1984', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'ML1M', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'unseen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 1, 'test_filtered_batch': 0, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_1984_ML1M_sequential,straightforward_t5-small_sequential_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML1M_sequential.pt'}
2025-03-10 01:24:40,949 - root - INFO - Generating data for ML1M dataset
2025-03-10 01:24:40,949 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-10 01:24:40,950 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-10 01:24:40,950 - root - INFO - Required info: ['target', 'dataset', 'history', 'user_id']
2025-03-10 01:24:41,033 - root - INFO - Reindex data with sequential indexing method
2025-03-10 01:24:42,168 - root - INFO - loading training data
2025-03-10 01:24:46,975 - root - INFO - Getting prompt information
2025-03-10 01:25:23,556 - root - INFO - Input: Here is the purchase history of ML1M user_1 : ML1M item item_1015 , item_1016 , item_1017 , item_1018 , item_1019 , item_1020 , item_1021 , item_1022 , item_1023 , item_1024 , item_1025 , item_1026 , item_1027 , item_1028 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 . I wonder what is the next recommended item for the user . , Output: ML1M item_1035 
2025-03-10 01:25:23,744 - root - INFO - Use t5-small backbone model
2025-03-10 01:25:24,137 - root - INFO - Random initialize number related tokens
2025-03-10 01:25:26,660 - root - INFO - Load model from ../checkpoint/ML1M_sequential.pt
2025-03-10 01:25:27,605 - root - INFO - testing filtered ML1M dataset on sequential task
2025-03-10 19:32:26,895 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML1M_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '1984', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'ML1M', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'unseen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 1, 'test_filtered_batch': 0, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_1984_ML1M_sequential,straightforward_t5-small_sequential_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML1M_sequential.pt'}
2025-03-10 19:32:26,897 - root - INFO - Generating data for ML1M dataset
2025-03-10 19:32:26,897 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-10 19:32:26,898 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-10 19:32:26,898 - root - INFO - Required info: ['user_id', 'dataset', 'target', 'history']
2025-03-10 19:32:26,998 - root - INFO - Reindex data with sequential indexing method
2025-03-10 19:32:28,592 - root - INFO - loading training data
2025-03-10 19:32:33,358 - root - INFO - Getting prompt information
2025-03-10 19:33:09,199 - root - INFO - Input: Here is the purchase history of ML1M user_1 : ML1M item item_1015 , item_1016 , item_1017 , item_1018 , item_1019 , item_1020 , item_1021 , item_1022 , item_1023 , item_1024 , item_1025 , item_1026 , item_1027 , item_1028 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 . I wonder what is the next recommended item for the user . , Output: ML1M item_1035 
2025-03-10 19:33:09,414 - root - INFO - Use t5-small backbone model
2025-03-10 19:33:10,150 - root - INFO - Random initialize number related tokens
2025-03-10 19:33:12,599 - root - INFO - Load model from ../checkpoint/ML1M_sequential.pt
2025-03-10 19:33:13,496 - root - INFO - testing filtered ML1M dataset on sequential task
2025-03-11 20:23:16,469 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML1M_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '1984', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'ML1M', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'unseen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 1, 'test_filtered_batch': 0, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_1984_ML1M_sequential,straightforward_t5-small_sequential_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML1M_sequential.pt'}
2025-03-11 20:23:16,470 - root - INFO - Generating data for ML1M dataset
2025-03-11 20:23:16,471 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 20:23:16,473 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 20:23:16,473 - root - INFO - Required info: ['dataset', 'history', 'target', 'user_id']
2025-03-11 20:23:16,588 - root - INFO - Reindex data with sequential indexing method
2025-03-11 20:23:24,403 - root - INFO - loading training data
2025-03-11 20:23:29,428 - root - INFO - Getting prompt information
2025-03-11 20:24:04,878 - root - INFO - Input: Here is the purchase history of ML1M user_1 : ML1M item item_1015 , item_1016 , item_1017 , item_1018 , item_1019 , item_1020 , item_1021 , item_1022 , item_1023 , item_1024 , item_1025 , item_1026 , item_1027 , item_1028 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 . I wonder what is the next recommended item for the user . , Output: ML1M item_1035 
2025-03-11 20:24:05,355 - root - INFO - Use t5-small backbone model
2025-03-12 00:48:29,090 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML1M_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '1984', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'ML1M', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'unseen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 1, 'test_filtered_batch': 0, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_1984_ML1M_sequential,straightforward_t5-small_sequential_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML1M_sequential.pt'}
2025-03-12 00:48:29,092 - root - INFO - Generating data for ML1M dataset
2025-03-12 00:48:29,092 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-12 00:48:29,094 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-12 00:48:29,094 - root - INFO - Required info: ['target', 'dataset', 'user_id', 'history']
2025-03-12 00:48:29,200 - root - INFO - Reindex data with sequential indexing method
2025-03-12 00:48:34,953 - root - INFO - loading training data
2025-03-12 00:48:39,964 - root - INFO - Getting prompt information
2025-03-12 00:49:15,185 - root - INFO - Input: Here is the purchase history of ML1M user_1 : ML1M item item_1015 , item_1016 , item_1017 , item_1018 , item_1019 , item_1020 , item_1021 , item_1022 , item_1023 , item_1024 , item_1025 , item_1026 , item_1027 , item_1028 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 . I wonder what is the next recommended item for the user . , Output: ML1M item_1035 
2025-03-12 00:49:16,008 - root - INFO - Use t5-small backbone model
2025-03-12 00:49:17,382 - root - INFO - Random initialize number related tokens
2025-03-12 00:49:23,575 - root - INFO - Load model from ../checkpoint/ML1M_sequential.pt
2025-03-12 00:51:39,849 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML1M_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '1984', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'ML1M', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'unseen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 1, 'test_filtered_batch': 0, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_1984_ML1M_sequential,straightforward_t5-small_sequential_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML1M_sequential.pt'}
2025-03-12 00:51:39,850 - root - INFO - Generating data for ML1M dataset
2025-03-12 00:51:39,850 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-12 00:51:39,851 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-12 00:51:39,851 - root - INFO - Required info: ['history', 'user_id', 'dataset', 'target']
2025-03-12 00:51:39,946 - root - INFO - Reindex data with sequential indexing method
2025-03-12 00:51:41,734 - root - INFO - loading training data
2025-03-12 00:51:46,555 - root - INFO - Getting prompt information
2025-03-12 00:52:21,008 - root - INFO - Input: Here is the purchase history of ML1M user_1 : ML1M item item_1015 , item_1016 , item_1017 , item_1018 , item_1019 , item_1020 , item_1021 , item_1022 , item_1023 , item_1024 , item_1025 , item_1026 , item_1027 , item_1028 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 . I wonder what is the next recommended item for the user . , Output: ML1M item_1035 
2025-03-12 00:52:21,840 - root - INFO - Use t5-small backbone model
2025-03-12 00:52:23,448 - root - INFO - Random initialize number related tokens
2025-03-12 00:52:26,868 - root - INFO - Load model from ../checkpoint/ML1M_sequential.pt
2025-03-12 00:57:42,097 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML1M_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '1984', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'ML1M', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'unseen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 1, 'test_filtered_batch': 0, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_1984_ML1M_sequential,straightforward_t5-small_sequential_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML1M_sequential.pt'}
2025-03-12 00:57:42,098 - root - INFO - Generating data for ML1M dataset
2025-03-12 00:57:42,098 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-12 00:57:42,099 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-12 00:57:42,099 - root - INFO - Required info: ['history', 'target', 'dataset', 'user_id']
2025-03-12 00:57:42,193 - root - INFO - Reindex data with sequential indexing method
2025-03-12 00:57:44,070 - root - INFO - loading training data
2025-03-12 00:57:48,907 - root - INFO - Getting prompt information
2025-03-12 00:58:23,956 - root - INFO - Input: Here is the purchase history of ML1M user_1 : ML1M item item_1015 , item_1016 , item_1017 , item_1018 , item_1019 , item_1020 , item_1021 , item_1022 , item_1023 , item_1024 , item_1025 , item_1026 , item_1027 , item_1028 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 . I wonder what is the next recommended item for the user . , Output: ML1M item_1035 
2025-03-12 00:58:24,733 - root - INFO - Use t5-small backbone model
2025-03-12 00:58:25,859 - root - INFO - Random initialize number related tokens
2025-03-12 00:58:29,575 - root - INFO - Load model from ../checkpoint/ML1M_sequential.pt
2025-03-12 03:09:55,219 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML1M_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '1984', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'ML1M', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'unseen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 1, 'test_filtered_batch': 0, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_1984_ML1M_sequential,straightforward_t5-small_sequential_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML1M_sequential.pt'}
2025-03-12 03:09:55,221 - root - INFO - Generating data for ML1M dataset
2025-03-12 03:09:55,221 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-12 03:09:55,224 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-12 03:09:55,224 - root - INFO - Required info: ['dataset', 'history', 'target', 'user_id']
2025-03-12 03:09:55,352 - root - INFO - Reindex data with sequential indexing method
2025-03-12 03:10:02,740 - root - INFO - loading training data
2025-03-12 03:10:07,579 - root - INFO - Getting prompt information
2025-03-12 03:10:41,203 - root - INFO - Input: Here is the purchase history of ML1M user_1 : ML1M item item_1015 , item_1016 , item_1017 , item_1018 , item_1019 , item_1020 , item_1021 , item_1022 , item_1023 , item_1024 , item_1025 , item_1026 , item_1027 , item_1028 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 . I wonder what is the next recommended item for the user . , Output: ML1M item_1035 
2025-03-12 03:10:41,618 - root - INFO - Use t5-small backbone model
2025-03-12 03:10:44,077 - root - INFO - Random initialize number related tokens
2025-03-12 03:10:47,619 - root - INFO - Load model from ../checkpoint/ML1M_sequential.pt
2025-03-12 03:27:50,302 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML1M_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '1984', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'ML1M', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'unseen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 1, 'test_filtered_batch': 0, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_1984_ML1M_sequential,straightforward_t5-small_sequential_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML1M_sequential.pt'}
2025-03-12 03:27:50,304 - root - INFO - Generating data for ML1M dataset
2025-03-12 03:27:50,304 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-12 03:27:50,306 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-12 03:27:50,306 - root - INFO - Required info: ['dataset', 'target', 'history', 'user_id']
2025-03-12 03:27:50,412 - root - INFO - Reindex data with sequential indexing method
2025-03-12 03:27:55,488 - root - INFO - loading training data
2025-03-12 03:28:00,380 - root - INFO - Getting prompt information
2025-03-12 03:28:34,331 - root - INFO - Input: Here is the purchase history of ML1M user_1 : ML1M item item_1015 , item_1016 , item_1017 , item_1018 , item_1019 , item_1020 , item_1021 , item_1022 , item_1023 , item_1024 , item_1025 , item_1026 , item_1027 , item_1028 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 . I wonder what is the next recommended item for the user . , Output: ML1M item_1035 
2025-03-12 03:28:34,785 - root - INFO - Use t5-small backbone model
2025-03-12 03:28:36,517 - root - INFO - Random initialize number related tokens
2025-03-12 03:28:40,052 - root - INFO - Load model from ../checkpoint/ML1M_sequential.pt
2025-03-12 03:28:40,896 - root - INFO - testing filtered ML1M dataset on sequential task
2025-03-12 03:55:13,514 - root - INFO - hit@5: 0.21158940397350992
2025-03-12 03:55:13,517 - root - INFO - hit@10: 0.3054635761589404
2025-03-12 03:55:13,517 - root - INFO - ndcg@5: 0.1436062828630161
2025-03-12 03:55:13,517 - root - INFO - ndcg@10: 0.17373344645237984
2025-03-12 03:55:13,518 - root - INFO - testing filtered ML1M dataset on straightforward task
2025-03-12 04:21:53,853 - root - INFO - hit@5: 0.03162251655629139
2025-03-12 04:21:53,857 - root - INFO - hit@10: 0.05662251655629139
2025-03-12 04:21:53,857 - root - INFO - ndcg@5: 0.019250309582780168
2025-03-12 04:21:53,857 - root - INFO - ndcg@10: 0.02721582226964422
2025-03-12 15:32:43,607 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML1M_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '1984', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'ML1M', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'unseen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 1, 'test_filtered_batch': 0, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_1984_ML1M_sequential,straightforward_t5-small_sequential_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML1M_sequential.pt'}
2025-03-12 15:32:43,609 - root - INFO - Generating data for ML1M dataset
2025-03-12 15:32:43,609 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-12 15:32:43,610 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-12 15:32:43,610 - root - INFO - Required info: ['target', 'user_id', 'dataset', 'history']
2025-03-12 15:32:43,729 - root - INFO - Reindex data with sequential indexing method
2025-03-12 15:33:01,690 - root - INFO - loading training data
2025-03-12 15:33:06,568 - root - INFO - Getting prompt information
2025-03-12 15:33:40,845 - root - INFO - Input: Here is the purchase history of ML1M user_1 : ML1M item item_1015 , item_1016 , item_1017 , item_1018 , item_1019 , item_1020 , item_1021 , item_1022 , item_1023 , item_1024 , item_1025 , item_1026 , item_1027 , item_1028 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 . I wonder what is the next recommended item for the user . , Output: ML1M item_1035 
2025-03-12 15:33:41,233 - root - INFO - Use t5-small backbone model
2025-03-12 15:33:43,700 - root - INFO - Random initialize number related tokens
2025-03-12 15:33:47,352 - root - INFO - Load model from ../checkpoint/ML1M_sequential.pt
2025-03-12 15:33:48,034 - root - INFO - testing filtered ML1M dataset on sequential task
2025-03-12 16:00:29,821 - root - INFO - hit@5: 0.21158940397350992
2025-03-12 16:00:29,825 - root - INFO - hit@10: 0.3054635761589404
2025-03-12 16:00:29,825 - root - INFO - ndcg@5: 0.1436062828630161
2025-03-12 16:00:29,825 - root - INFO - ndcg@10: 0.17373344645237984
2025-03-12 16:00:29,827 - root - INFO - testing filtered ML1M dataset on straightforward task
2025-03-12 16:27:20,049 - root - INFO - hit@5: 0.03162251655629139
2025-03-12 16:27:20,053 - root - INFO - hit@10: 0.05662251655629139
2025-03-12 16:27:20,054 - root - INFO - ndcg@5: 0.019250309582780168
2025-03-12 16:27:20,054 - root - INFO - ndcg@10: 0.02721582226964422
