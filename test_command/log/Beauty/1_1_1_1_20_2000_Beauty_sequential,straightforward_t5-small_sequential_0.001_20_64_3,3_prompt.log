2025-03-10 19:54:01,296 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '0,1,2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 4, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-10 19:54:01,297 - root - INFO - Generating data for Beauty dataset
2025-03-10 19:54:01,297 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-10 19:54:01,298 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-10 19:54:01,298 - root - INFO - Required info: ['dataset', 'target', 'user_id', 'history']
2025-03-10 19:54:01,373 - root - INFO - Reindex data with sequential indexing method
2025-03-10 19:54:03,524 - root - INFO - loading training data
2025-03-10 19:54:04,310 - root - INFO - Getting prompt information
2025-03-10 19:54:14,030 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-10 19:54:14,336 - root - INFO - Use t5-small backbone model
2025-03-10 19:54:15,131 - root - INFO - Random initialize number related tokens
2025-03-10 19:54:19,733 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-10 20:22:52,190 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '0,1,2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 4, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-10 20:22:52,192 - root - INFO - Generating data for Beauty dataset
2025-03-10 20:22:52,192 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-10 20:22:52,193 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-10 20:22:52,193 - root - INFO - Required info: ['dataset', 'history', 'user_id', 'target']
2025-03-10 20:22:52,278 - root - INFO - Reindex data with sequential indexing method
2025-03-10 20:22:54,427 - root - INFO - loading training data
2025-03-10 20:22:55,056 - root - INFO - Getting prompt information
2025-03-10 20:23:05,181 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-10 20:23:05,486 - root - INFO - Use t5-small backbone model
2025-03-10 20:23:08,967 - root - INFO - Random initialize number related tokens
2025-03-10 20:23:16,936 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-10 21:54:48,829 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '0,1,2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt', 'rank': 0}
2025-03-10 21:54:48,960 - root - INFO - Generating data for Beauty dataset
2025-03-10 21:54:48,960 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-10 21:54:48,963 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-10 21:54:48,963 - root - INFO - Required info: ['user_id', 'history', 'target', 'dataset']
2025-03-10 21:54:49,033 - root - INFO - Reindex data with sequential indexing method
2025-03-11 01:14:46,071 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '0,1,2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 4, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 01:14:46,073 - root - INFO - Generating data for Beauty dataset
2025-03-11 01:14:46,073 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 01:14:46,075 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 01:14:46,076 - root - INFO - Required info: ['user_id', 'target', 'dataset', 'history']
2025-03-11 01:14:46,213 - root - INFO - Reindex data with sequential indexing method
2025-03-11 01:15:01,415 - root - INFO - loading training data
2025-03-11 01:15:02,313 - root - INFO - Getting prompt information
2025-03-11 01:15:11,963 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 01:15:12,332 - root - INFO - Use t5-small backbone model
2025-03-11 20:21:56,771 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '0,1,2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 4, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 20:21:56,773 - root - INFO - Generating data for Beauty dataset
2025-03-11 20:21:56,773 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 20:21:56,776 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 20:21:56,776 - root - INFO - Required info: ['target', 'user_id', 'history', 'dataset']
2025-03-11 20:21:56,833 - root - INFO - Reindex data with sequential indexing method
2025-03-11 20:22:19,489 - root - INFO - loading training data
2025-03-11 20:22:20,380 - root - INFO - Getting prompt information
2025-03-11 20:22:29,988 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 20:22:30,356 - root - INFO - Use t5-small backbone model
2025-03-11 20:46:50,925 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '0,1,2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 4, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 20:46:50,927 - root - INFO - Generating data for Beauty dataset
2025-03-11 20:46:50,927 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 20:46:50,930 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 20:46:50,930 - root - INFO - Required info: ['user_id', 'target', 'history', 'dataset']
2025-03-11 20:46:51,035 - root - INFO - Reindex data with sequential indexing method
2025-03-11 20:47:13,250 - root - INFO - loading training data
2025-03-11 20:47:14,161 - root - INFO - Getting prompt information
2025-03-11 20:47:23,717 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 20:47:24,058 - root - INFO - Use t5-small backbone model
2025-03-11 21:14:09,826 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '0,1,2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 4, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 21:14:09,828 - root - INFO - Generating data for Beauty dataset
2025-03-11 21:14:09,829 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 21:14:09,832 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 21:14:09,832 - root - INFO - Required info: ['dataset', 'history', 'user_id', 'target']
2025-03-11 21:14:09,960 - root - INFO - Reindex data with sequential indexing method
2025-03-11 21:14:31,240 - root - INFO - loading training data
2025-03-11 21:14:32,160 - root - INFO - Getting prompt information
2025-03-11 21:14:41,607 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 21:14:42,071 - root - INFO - Use t5-small backbone model
2025-03-11 21:22:03,295 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '0,1,2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 4, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 21:22:03,297 - root - INFO - Generating data for Beauty dataset
2025-03-11 21:22:03,297 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 21:22:03,299 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 21:22:03,300 - root - INFO - Required info: ['dataset', 'target', 'history', 'user_id']
2025-03-11 21:22:03,404 - root - INFO - Reindex data with sequential indexing method
2025-03-11 21:22:24,392 - root - INFO - loading training data
2025-03-11 21:22:25,340 - root - INFO - Getting prompt information
2025-03-11 21:22:34,899 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 21:22:35,189 - root - INFO - Use t5-small backbone model
2025-03-11 21:38:41,267 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '0,1,2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 4, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 21:38:41,269 - root - INFO - Generating data for Beauty dataset
2025-03-11 21:38:41,269 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 21:38:41,272 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 21:38:41,272 - root - INFO - Required info: ['history', 'dataset', 'user_id', 'target']
2025-03-11 21:38:41,355 - root - INFO - Reindex data with sequential indexing method
2025-03-11 21:38:46,766 - root - INFO - loading training data
2025-03-11 21:38:47,549 - root - INFO - Getting prompt information
2025-03-11 21:38:57,229 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 21:38:57,439 - root - INFO - Use t5-small backbone model
2025-03-11 21:39:00,773 - root - INFO - Random initialize number related tokens
2025-03-11 21:39:07,056 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-11 22:14:17,952 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 22:14:17,953 - root - INFO - Generating data for Beauty dataset
2025-03-11 22:14:17,953 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 22:14:17,955 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 22:14:17,956 - root - INFO - Required info: ['target', 'history', 'dataset', 'user_id']
2025-03-11 22:14:18,008 - root - INFO - Reindex data with sequential indexing method
2025-03-11 22:14:21,615 - root - INFO - loading training data
2025-03-11 22:14:21,967 - root - INFO - Getting prompt information
2025-03-11 22:14:26,808 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 22:14:27,264 - root - INFO - Use t5-small backbone model
2025-03-11 22:14:28,921 - root - INFO - Random initialize number related tokens
2025-03-11 22:14:31,823 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-11 22:31:06,168 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 22:31:06,170 - root - INFO - Generating data for Beauty dataset
2025-03-11 22:31:06,170 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 22:31:06,172 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 22:31:06,172 - root - INFO - Required info: ['target', 'history', 'dataset', 'user_id']
2025-03-11 22:31:06,226 - root - INFO - Reindex data with sequential indexing method
2025-03-11 22:31:08,598 - root - INFO - loading training data
2025-03-11 22:31:08,962 - root - INFO - Getting prompt information
2025-03-11 22:31:13,870 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 22:31:14,328 - root - INFO - Use t5-small backbone model
2025-03-11 22:31:15,986 - root - INFO - Random initialize number related tokens
2025-03-11 22:31:18,740 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-11 22:41:30,501 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 22:41:30,501 - root - INFO - Generating data for Beauty dataset
2025-03-11 22:41:30,502 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 22:41:30,504 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 22:41:30,505 - root - INFO - Required info: ['user_id', 'target', 'dataset', 'history']
2025-03-11 22:41:30,557 - root - INFO - Reindex data with sequential indexing method
2025-03-11 22:41:33,874 - root - INFO - loading training data
2025-03-11 22:41:34,241 - root - INFO - Getting prompt information
2025-03-11 22:41:39,042 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 22:41:39,537 - root - INFO - Use t5-small backbone model
2025-03-11 22:41:41,111 - root - INFO - Random initialize number related tokens
2025-03-11 22:41:44,027 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-11 22:47:58,779 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 22:47:58,780 - root - INFO - Generating data for Beauty dataset
2025-03-11 22:47:58,780 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 22:47:58,781 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 22:47:58,782 - root - INFO - Required info: ['history', 'target', 'dataset', 'user_id']
2025-03-11 22:47:58,830 - root - INFO - Reindex data with sequential indexing method
2025-03-11 22:48:01,538 - root - INFO - loading training data
2025-03-11 22:48:01,897 - root - INFO - Getting prompt information
2025-03-11 22:48:06,680 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 22:48:07,130 - root - INFO - Use t5-small backbone model
2025-03-11 22:48:08,880 - root - INFO - Random initialize number related tokens
2025-03-11 22:48:11,830 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-11 22:51:35,742 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 22:51:35,743 - root - INFO - Generating data for Beauty dataset
2025-03-11 22:51:35,743 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 22:51:35,744 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 22:51:35,745 - root - INFO - Required info: ['user_id', 'target', 'history', 'dataset']
2025-03-11 22:51:35,796 - root - INFO - Reindex data with sequential indexing method
2025-03-11 22:51:38,300 - root - INFO - loading training data
2025-03-11 22:51:38,666 - root - INFO - Getting prompt information
2025-03-11 22:51:43,402 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 22:51:43,868 - root - INFO - Use t5-small backbone model
2025-03-11 22:51:45,534 - root - INFO - Random initialize number related tokens
2025-03-11 22:51:48,238 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-11 22:51:50,887 - root - INFO - testing Beauty dataset on sequential task
2025-03-11 22:51:51,811 - torch.distributed.nn.jit.instantiator - INFO - Created a temporary directory at /tmp/tmp99ltd77m
2025-03-11 22:51:51,811 - torch.distributed.nn.jit.instantiator - INFO - Writing /tmp/tmp99ltd77m/_remote_module_non_scriptable.py
2025-03-11 22:51:52,099 - torch.distributed.nn.jit.instantiator - INFO - Created a temporary directory at /tmp/tmpe0znsogf
2025-03-11 22:51:52,100 - torch.distributed.nn.jit.instantiator - INFO - Writing /tmp/tmpe0znsogf/_remote_module_non_scriptable.py
2025-03-11 23:00:19,945 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 23:00:19,945 - root - INFO - Generating data for Beauty dataset
2025-03-11 23:00:19,945 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 23:00:19,946 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 23:00:19,946 - root - INFO - Required info: ['dataset', 'history', 'user_id', 'target']
2025-03-11 23:00:19,992 - root - INFO - Reindex data with sequential indexing method
2025-03-11 23:00:22,417 - root - INFO - loading training data
2025-03-11 23:00:22,777 - root - INFO - Getting prompt information
2025-03-11 23:00:27,546 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 23:00:28,022 - root - INFO - Use t5-small backbone model
2025-03-11 23:00:29,691 - root - INFO - Random initialize number related tokens
2025-03-11 23:00:32,519 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-11 23:00:34,520 - root - INFO - testing Beauty dataset on sequential task
2025-03-11 23:00:35,189 - torch.distributed.nn.jit.instantiator - INFO - Created a temporary directory at /tmp/tmp4rsn631j
2025-03-11 23:00:35,190 - torch.distributed.nn.jit.instantiator - INFO - Writing /tmp/tmp4rsn631j/_remote_module_non_scriptable.py
2025-03-11 23:07:47,000 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 23:07:47,001 - root - INFO - Generating data for Beauty dataset
2025-03-11 23:07:47,001 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 23:07:47,002 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 23:07:47,003 - root - INFO - Required info: ['user_id', 'history', 'target', 'dataset']
2025-03-11 23:07:47,054 - root - INFO - Reindex data with sequential indexing method
2025-03-11 23:07:49,493 - root - INFO - loading training data
2025-03-11 23:07:49,863 - root - INFO - Getting prompt information
2025-03-11 23:07:54,723 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 23:07:55,203 - root - INFO - Use t5-small backbone model
2025-03-11 23:07:59,826 - root - INFO - Random initialize number related tokens
2025-03-11 23:08:02,094 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-11 23:08:03,757 - root - INFO - testing Beauty dataset on sequential task
2025-03-11 23:08:04,538 - torch.distributed.nn.jit.instantiator - INFO - Created a temporary directory at /tmp/tmpldsewt4k
2025-03-11 23:08:04,539 - torch.distributed.nn.jit.instantiator - INFO - Writing /tmp/tmpldsewt4k/_remote_module_non_scriptable.py
2025-03-11 23:08:06,698 - torch.distributed.nn.jit.instantiator - INFO - Created a temporary directory at /tmp/tmp7ybzq5l7
2025-03-11 23:08:06,698 - torch.distributed.nn.jit.instantiator - INFO - Writing /tmp/tmp7ybzq5l7/_remote_module_non_scriptable.py
2025-03-11 23:11:48,424 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 23:11:48,424 - root - INFO - Generating data for Beauty dataset
2025-03-11 23:11:48,424 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 23:11:48,425 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 23:11:48,426 - root - INFO - Required info: ['target', 'user_id', 'dataset', 'history']
2025-03-11 23:11:48,476 - root - INFO - Reindex data with sequential indexing method
2025-03-11 23:11:50,484 - root - INFO - loading training data
2025-03-11 23:11:50,856 - root - INFO - Getting prompt information
2025-03-11 23:11:55,618 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 23:11:56,064 - root - INFO - Use t5-small backbone model
2025-03-11 23:11:57,912 - root - INFO - Random initialize number related tokens
2025-03-11 23:12:00,627 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-11 23:12:02,308 - root - INFO - testing Beauty dataset on sequential task
2025-03-11 23:12:02,984 - torch.distributed.nn.jit.instantiator - INFO - Created a temporary directory at /tmp/tmpnaesqvje
2025-03-11 23:12:02,984 - torch.distributed.nn.jit.instantiator - INFO - Writing /tmp/tmpnaesqvje/_remote_module_non_scriptable.py
2025-03-11 23:29:17,316 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'Beauty_sequential.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '2,3', 'master_addr': 'localhost', 'master_port': '2000', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'sequential', 'tasks': 'sequential,straightforward', 'datasets': 'Beauty', 'prompt_file': '../../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 200, 'collaborative_cluster': 20, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 64, 'eval_batch_size': 1, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 20, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 1, 'valid_select': 0, 'test_before_train': 1, 'test_filtered': 0, 'test_filtered_batch': 1, 'world_size': 2, 'rank': 0, 'log_name': '1_1_1_1_20_2000_Beauty_sequential,straightforward_t5-small_sequential_0.001_20_64_3,3_prompt', 'model_path': '../checkpoint/Beauty_sequential.pt'}
2025-03-11 23:29:17,318 - root - INFO - Generating data for Beauty dataset
2025-03-11 23:29:17,318 - root - INFO - Get prompt template from ../../prompt.txt
2025-03-11 23:29:17,319 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2025-03-11 23:29:17,319 - root - INFO - Required info: ['dataset', 'target', 'history', 'user_id']
2025-03-11 23:29:17,372 - root - INFO - Reindex data with sequential indexing method
2025-03-11 23:29:20,170 - root - INFO - loading training data
2025-03-11 23:29:20,527 - root - INFO - Getting prompt information
2025-03-11 23:29:25,317 - root - INFO - Input: Here is the purchase history of Beauty user_6 : Beauty item item_1026 , item_1027 , item_1028 , item_1009 , item_1029 , item_1030 , item_1031 , item_1032 , item_1033 , item_1034 , item_1035 , item_1036 , item_1037 . I wonder what is the next recommended item for the user . , Output: Beauty item_1038 
2025-03-11 23:29:25,792 - root - INFO - Use t5-small backbone model
2025-03-11 23:29:27,487 - root - INFO - Random initialize number related tokens
2025-03-11 23:29:30,334 - root - INFO - Load model from ../checkpoint/Beauty_sequential.pt
2025-03-11 23:29:32,786 - root - INFO - testing Beauty dataset on sequential task
2025-03-11 23:29:33,578 - torch.distributed.nn.jit.instantiator - INFO - Created a temporary directory at /tmp/tmplr6srf40
2025-03-11 23:29:33,579 - torch.distributed.nn.jit.instantiator - INFO - Writing /tmp/tmplr6srf40/_remote_module_non_scriptable.py
2025-03-11 23:29:35,709 - torch.distributed.nn.jit.instantiator - INFO - Created a temporary directory at /tmp/tmp9xxjn59i
2025-03-11 23:29:35,710 - torch.distributed.nn.jit.instantiator - INFO - Writing /tmp/tmp9xxjn59i/_remote_module_non_scriptable.py
2025-03-12 00:11:51,931 - root - INFO - hit@5: 0.045564299767483454
2025-03-12 00:11:51,934 - root - INFO - hit@10: 0.0621981756394205
2025-03-12 00:11:51,935 - root - INFO - ndcg@5: 0.03349838229607425
2025-03-12 00:11:51,935 - root - INFO - ndcg@10: 0.03888801411160806
2025-03-12 00:11:51,937 - root - INFO - testing Beauty dataset on straightforward task
2025-03-12 00:42:30,429 - root - INFO - hit@5: 0.03179216598104096
2025-03-12 00:42:30,432 - root - INFO - hit@10: 0.04386514040422107
2025-03-12 00:42:30,432 - root - INFO - ndcg@5: 0.023922331422534054
2025-03-12 00:42:30,432 - root - INFO - ndcg@10: 0.027786151189469022
